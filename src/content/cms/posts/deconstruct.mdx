---
title: Deconstruct
date: 2020-10-16T22:00:00.000Z
meta:
  title: Deconstruct
  description: >-
    Chuy·ªán v·ªÅ m·ªôt chi·∫øc source code ƒë√£ c≈©.
  permalink: /blog/deconstruct/
  ogImage: /assets/posts/deconstruct-title.png
---

V·ª´a r·ªìi, m√¨nh c√≥ m·ªôt bu·ªïi tech talk ·ªü c√¥ng ty, v·ªõi ch·ªß ƒë·ªÅ kh√¥ng ph·∫£i v·ªÅ React, React Native, hay th·∫≠m ch√≠ JavaScript. M·ªôt ch·ªß ƒë·ªÅ m·ªõi nh∆∞ng kh√¥ng c≈©, v·ªÅ nh·ªØng ƒëi·ªÅu m√† n·∫øu m√¨nh c√≥ m·ªôt c·ªó m√°y th·ªùi gian, m√¨nh s·∫Ω quay tr·ªü l·∫°i ƒë·ªÉ n√≥i v·ªõi ch√≠nh m√¨nh c·ªßa qu√° kh·ª©, nh·ªØng ƒëi·ªÅu m√† m√¨nh mu·ªën tin r·∫±ng, c√≥ th·ªÉ t·∫°o n√™n m·ªôt s·ª± kh√°c bi·ªát.

![Deconstruct Title](/assets/posts/deconstruct-title.png "Deconstruct")

## I. The DRY Codebase

ƒê√≥ l√† m·ªôt d·ª± √°n m√¨nh c√πng team th·ª±c hi·ªán nhi·ªÅu nƒÉm v·ªÅ tr∆∞·ªõc. L√∫c n√†y, c√≥ hai module n·∫±m ·ªü hai file kh√°c nhau. V√† nh√≥m ƒëang ph√°t tri·ªÉn m·ªôt t√≠nh nƒÉng m·ªõi ·ªü m·ªôt trong hai file. M·ªçi ng∆∞·ªùi ph√°t hi·ªán r·∫±ng t√≠nh nƒÉng n√†y th·∫≠t ra r·∫•t gi·ªëng v·ªõi m·ªôt c√°i ƒë√£ c√≥ s·∫µn ·ªü file kia. V·∫≠y n√™n t·∫•t c·∫£ quy·∫øt ƒë·ªãnh sao ch√©p ƒëo·∫°n code n√†y b·ªüi v√¨ ch√∫ng g·∫ßn nh∆∞ gi·ªëng nhau.

![deconstruct](/assets/posts/deconstruct-01.gif "Deconstruct")

M√¨nh nh·∫≠n nhi·ªám v·ª• review qua ƒëo·∫°n code, sau khi ƒë√£ ƒë·ªçc h·∫øt nh·ªØng s√°ch v·ªÅ ‚Äúbest pratices‚Äù. Well Groomed Code, Pragmatic Programmer, Clean Coder‚Ä¶ V√† m√¨nh bi·∫øt r·∫±ng kh√¥ng ƒë∆∞·ª£c copy-paste code v√¨ vi·ªác n√†y s·∫Ω h√¨nh th√†nh m·ªôt **‚Äùmaintenance burden‚Äù** v√† s·∫Ω tr·ªü n√™n r·∫•t kh√≥ ƒë·ªÉ ti·∫øp t·ª•c ph√°t tri·ªÉn. M√¨nh c≈©ng h·ªçc ƒë∆∞·ª£c kh√°i ni·ªám **DRY**, vi·∫øt t·∫Øt cho Don‚Äôt Repeat Yourself. M·ªôt quan ni·ªám r·∫•t ph·ªï bi·∫øn t·ª´ khi v·ª´a h·ªçc l·∫≠p tr√¨nh: Kh√¥ng ƒë∆∞·ª£c ƒë·ªÉ l·∫∑p code.

![deconstruct](/assets/posts/deconstruct-dry.png "Deconstruct")

V·∫≠y l√† m√¨nh c√πng team ƒëi ƒë·∫øn quy·∫øt ƒë·ªãnh t√°ch ƒëo·∫°n m√£ ·∫•y ra m·ªôt module ri√™ng ƒë·ªÉ hai file n√†y c√πng ph·ª• thu·ªôc v√†o. M·ªôt **Abstraction** (l·ªõp tr·ª´u t∆∞·ª£ng) ƒë∆∞·ª£c h√¨nh th√†nh.

![deconstruct](/assets/posts/deconstruct-02.gif "Deconstruct")

ƒê·ªãnh nghƒ©a **Abstraction** ·ªü ƒë√¢y, kh√¥ng quan tr·ªçng vi·ªác s·ª≠ d·ª•ng ng√¥n ng·ªØ n√†o. N√≥ c√≥ th·ªÉ l√† m·ªôt function, m·ªôt class, ho·∫∑c m·ªôt module, m·ªôt package, mi·ªÖn sao n√≥ c√≥ th·ªÉ reusable (t√°i s·ª≠ d·ª•ng) ·ªü b·∫•t k·ª≥ ƒë√¢u trong codebase.

M·ªçi ng∆∞·ªùi ƒë·ªÅu c·∫£m th·∫•y h√†i l√≤ng, v√† ƒë√£ c√πng nhau c√≥ m·ªôt cu·ªôc s·ªëng h·∫°nh ph√∫c‚Ä¶

![deconstruct](/assets/posts/deconstruct-thumb.png "Deconstruct")

Nhi·ªÅu th√°ng sau, d·ª± √°n nh·∫≠n th√™m m·ªôt phase m·ªõi khi team ƒë√£ kh√¥ng ƒë·ª•ng v√†o source code n√†y m·ªôt kho·∫£ng th·ªùi gian. Trong ƒë√≥ c√≥ m·ªôt feature c·∫ßn m·ªôt th·ª© g·∫ßn t∆∞∆°ng t·ª± nh∆∞ chi·∫øc abstraction ng√†y x∆∞a ch√∫ng t√¥i c√πng theo ƒëu·ªïi. L·∫•y v√≠ d·ª• nh∆∞, abstraction ban ƒë·∫ßu l√† m·ªôt function ch·∫°y asynchronous (b·∫•t ƒë·ªìng b·ªô), v√† ch√∫ng ta c·∫ßn m·ªôt function c√≥ c·∫•u tr√∫c g·∫ßn nh∆∞ t∆∞∆°ng t·ª±, ngo·∫°i tr·ª´ vi·ªác n√≥ c√≥ th·ªÉ ch·∫°y synchronous.

![deconstruct](/assets/posts/deconstruct-03.gif "Deconstruct")

V·∫≠y l√† d√π ta kh√¥ng th·ªÉ tr·ª±c ti·∫øp s·ª≠ d·ª•ng ƒëo·∫°n code ƒë√≥ n·ªØa, nh∆∞ng c≈©ng s·∫Ω kh√¥ng hay n·∫øu m√¨nh copy-paste n√≥ v√¨ n√≥ ch·∫≥ng kh√°c c√°i c≈© l√† bao. Team quy·∫øt ƒë·ªãnh h·ª£p nh·∫•t hai ph·∫ßn v√† ch·ªânh s·ª≠a abstraction ƒë·ªÉ n√≥ c√≥ th·ªÉ gi·∫£i quy·∫øt cho t·∫•t c·∫£ tr∆∞·ªùng h·ª£p.

![deconstruct](/assets/posts/deconstruct-04.gif "Deconstruct")

Vi·ªác ch·ªânh s·ª≠a n√†y l√†m cho abstraction c√≥ m·ªôt ch√∫t k·ª≥ c·ª•c, nh∆∞ng √≠t ra ta c≈©ng kh√¥ng ph·∫£i l·∫∑p l·∫°i ƒëo·∫°n code ·∫•y?

![deconstruct](/assets/posts/deconstruct-unorthodox.png "Deconstruct")

Sau m·ªôt th·ªùi gian ng·∫Øn ch·∫°y production, team ph√°t hi·ªán m·ªôt bug trong feature m·ªõi n√†y. L·ªói xu·∫•t ph√°t t·ª´ vi·ªác ban ƒë·∫ßu t·∫•t c·∫£ nghƒ© r·∫±ng c·∫£ hai t√≠nh nƒÉng c√≥ v·∫ª gi·ªëng nhau, nh∆∞ng th·∫≠t ra ch√∫ng c√≥ m·ªôt ch√∫t x√≠u kh√°c bi·ªát. Dƒ© nhi√™n l√† m√¨nh c√≥ th·ªÉ fix bug n√†y, b·∫±ng c√°ch th√™m v√†o abstraction m·ªôt case ƒë·∫∑c bi·ªát, ki·ªÉu nh∆∞ m·ªôt c√¢u if-else ch·∫≥ng h·∫°n. N·∫øu n√≥ l√† case m·ªõi n√†y, m√¨nh s·∫Ω l√†m kh√°c m·ªôt ch√∫t, v√† m·ªçi th·ª© tr·ªü l·∫°i ho·∫°t ƒë·ªông.

![deconstruct](/assets/posts/deconstruct-05.gif "Deconstruct")

D·ªÖ th·∫•y ƒë√¢y c≈©ng l√† chuy·ªán b√¨nh th∆∞·ªùng c·ªßa m·ªôt abstraction trong qu√° tr√¨nh ph√°t tri·ªÉn.

Ti·∫øp t·ª•c l√†m vi·ªác v·ªõi feature n√†y, nh√≥m ph√°t hi·ªán m·ªôt l·ªói m·ªõi trong m·ªôt module c≈©. S·ª± c·ªë n√†y x·∫£y ra do hai tr∆∞·ªùng h·ª£p c≈© m√† ch√∫ng t√¥i nghƒ© l√† gi·ªëng nhau n√†y th·ª±c ra c≈©ng c√≥ ch√∫t kh√°c bi·ªát m√† ch·ªâ l√† team kh√¥ng nh·∫≠n ra v√†o l√∫c ƒë·∫•y. V·∫≠y n√™n ch√∫ng t√¥i th√™m nh·ªØng ƒëo·∫°n patch kh√°c cho c√°c module v√†o abstraction.

![deconstruct](/assets/posts/deconstruct-06.gif "Deconstruct")

L√∫c n√†y, abstraction b·∫Øt ƒë·∫ßu tr·ªü n√™n h∆°i h∆°i k·ª≥ l·∫° v√† ƒë√°ng s·ª£. V·∫≠y n√™n h√£y l√†m cho n√≥ tr·ªü n√™n th√¢n thi·ªán h∆°n. Sao ta kh√¥ng ƒëem h·∫øt nh·ªØng case ƒë·∫∑c bi·ªát n√†y ra kh·ªèi abstraction?

![deconstruct](/assets/posts/deconstruct-07.gif "Deconstruct")

ƒê√∫ng v·∫≠y, ta k√©o t·∫•t c·∫£ nh·ªØng patch case v·ªÅ l·∫°i n∆°i ch√∫ng thu·ªôc v·ªÅ. Abstraction tr·ªü l·∫°i xinh ƒë·∫πp v√† kh√¥ng c√≤n d·ª±a theo m·ªôt tr∆∞·ªùng h·ª£p c·ª• th·ªÉ n√†o, d√π ch·∫≥ng c√≤n ai th·ª±c s·ª± hi·ªÉu ƒë∆∞·ª£c n√≥ ƒë·∫°i di·ªán cho c√°i g√¨ n·ªØa. Nh·ªØng module khi s·ª≠ d·ª•ng abstraction ƒë·ªÅu ph·∫£i ƒë∆∞·ª£c tham s·ªë ho√°.

S·ª± ti·∫øn tri·ªÉn n√†y di·ªÖn ra th·ª±c s·ª± ho√†n to√†n b√¨nh th∆∞·ªùng, m·ªói b∆∞·ªõc m·ªói b∆∞·ªõc ƒë·ªÅu c√≥ v·∫ª make sense v·ªõi nh·ªØng ng∆∞·ªùi vi·∫øt v√† review code, n√™n ch√∫ng t√¥i c·ª© ƒë·ªÉ cho n√≥ nh∆∞ v·∫≠y.

R·ªìi th·ªùi gian tr√¥i qua, m·ªôt s·ªë th√†nh vi√™n r·ªùi team, m·ªôt s·ªë m·ªõi join team. Tr·∫£i qua nhi·ªÅu b·∫£n update & s·ª≠a l·ªói. Ai ƒë√≥ s·ª≠a m·ªôt l·ªói nh·ªè ·ªü ƒë√¢y. Kh√¥ng c·∫ßn bi·∫øt c√°i n√†y ƒë·ªÉ l√†m g√¨ nh∆∞ng t√¥i c·∫ßn s·ª≠a n√≥ m·ªôt x√≠u, th√™m t√≠nh nƒÉng m·ªõi kia, c·∫£i thi·ªán v√†i ch·ªâ s·ªë hi·ªáu nƒÉng... V√† ta k·∫øt th√∫c b·∫±ng m·ªôt th·ª© gi·ªëng nh∆∞ n√†y:

![deconstruct](/assets/posts/deconstruct-monster.jpeg "Deconstruct")

Nh·∫Øc l·∫°i, m·ªói giai ƒëo·∫°n ph√°t tri·ªÉn ƒë·ªôc l·∫≠p c√≥ v·∫ª ƒë·ªÅu c√≥ l√Ω c·∫£. Nh∆∞ng ch·ªâ c·∫ßn qu√™n ƒëi m·ª•c ƒë√≠ch ban ƒë·∫ßu c·ªßa to√†n b·ªô qu√° tr√¨nh, ta s·∫Ω kh√¥ng nh·∫≠n ra c√≥ nh·ªØng cyclical dependency ƒëang h√¨nh th√†nh, hay m·∫•y d√≤ng code k·ª≥ l·∫° ·ªü ƒë√¢u ƒë√≥, v√¨ ta kh√¥ng c√≤n nh√¨n th·∫•y ƒë∆∞·ª£c b·ª©c tranh t·ªïng th·ªÉ n·ªØa. V√† dƒ© nhi√™n, trong th·ª±c t·∫ø, ƒë√¢y c≈©ng ch√≠nh l√† n∆°i m√† c√¢u chuy·ªán d·ª´ng l·∫°i. Kh√¥ng c√≤n ai mu·ªën ƒë·ª•ng v√¥ source code ƒë√≥ v√† n√≥ b·ªã v·ª©t ·ªü m·ªôt x√≥, cho t·ªõi khi ai ƒë√≥ vi·∫øt l·∫°i h·∫øt, r·ªìi nhi·ªÅu khi c√≤n ƒë∆∞·ª£c tƒÉng l∆∞∆°ng n·ªØa, m√¨nh nghƒ© v·∫≠y (haha).

Nh∆∞ng n·∫øu ta c√≥ m·ªôt c·ªó m√°y th·ªùi gian, sau khi t√¨m hi·ªÉu v·ªÅ v·∫≠t l√Ω l∆∞·ª£ng t·ª≠, c√°c th·ª© nhi·ªát ƒë·ªông l·ª±c h·ªçc v√† ƒë·∫£o ng∆∞·ª£c entropy c·ªßa v·∫≠t ch·∫•t ü§¶ M√¨nh quay l·∫°i qu√° kh·ª© ƒë·ªÉ s·ª≠a ch·ªØa nh·ªØng l·ªói l·∫ßm x∆∞a. V√† m√¨nh mu·ªën ch·ªçn th·ªùi ƒëi·ªÉm m√† abstraction v·∫´n c√≤n xinh t∆∞∆°i.

![deconstruct](/assets/posts/deconstruct-the-past.gif "Deconstruct")

Ch√∫ng t√¥i c√≥ tr∆∞·ªùng h·ª£p th·ª© ba n√†y v√† kh√¥ng mu·ªën ph·∫£i duplicate ƒëo·∫°n code d√π n√≥ h∆°i kh√°c m·ªôt ch√∫t. V·∫≠y n√™n ch√∫ng t√¥i ƒëang chu·∫©n b·ªã ch·ªânh s·ª≠a abstraction ƒë·ªÉ ƒë√°p ·ª©ng v·ªõi tr∆∞·ªùng h·ª£p m·ªõi. Nh∆∞ng n·∫øu m√¨nh c·ªßa ng√†y h√¥m nay c√≥ m·∫∑t ·ªü ƒë·∫•y, m√¨nh s·∫Ω n√≥i v·ªõi ch√≠nh b·∫£n th√¢n, h√£y **inline abstraction** n√†y!

![deconstruct](/assets/posts/deconstruct-inline.gif "Deconstruct")

Nghƒ©a inline ·ªü ƒë√¢y c·ªßa m√¨nh l√† h√£y copy-paste ph·∫ßn code v·ªÅ n∆°i c·∫ßn d√πng n√≥. ƒêi·ªÅu n√†y g√¢y ra m·ªôt s·ªë s·ª± tr√πng l·∫∑p nh∆∞ng s·∫Ω ti√™u di·ªát ƒë∆∞·ª£c con qu√°i v·∫≠t s·∫Øp ƒë∆∞·ª£c h√¨nh th√†nh. V√† dƒ© nhi√™n s·ª± duplicate l√† kh√¥ng ho√†n h·∫£o, nh∆∞ng wrong abstraction l·∫°i c√†ng kh√¥ng t·ªët. Ta c·∫ßn c√¢n b·∫±ng ƒë∆∞·ª£c c·∫£ hai v·∫•n ƒë·ªÅ.

C√°ch m√† h∆∞·ªõng ƒëi n√†y gi√∫p ta l√† b√¢y gi·ªù n·∫øu t√¨m th·∫•y bug v√† m√¨nh nh·∫≠n ra ch·ªó n√†y ph·∫£i kh√°c m·ªôt ch√∫t, ta ch·ªâ vi·ªác thay ƒë·ªïi n√≥ m√† kh√¥ng s·ª£ l√†m ·∫£nh h∆∞·ªüng ƒë·∫øn nh·ªØng ph·∫ßn kh√°c.

![deconstruct](/assets/posts/deconstruct-inline-benefit.gif "Deconstruct")

T√™n g·ªçi cho c√°ch l√†m n√†y l√† **WET** solution, vi·∫øt t·∫Øt cho "write every time", "write everything twice", hay "waste everyone's time", nh∆∞ m·ªôt c√°ch ch∆°i ch·ªØ v·ªõi DRY solution.

![deconstruct](/assets/posts/deconstruct-wet.jpeg "Deconstruct")

T·∫•t nhi√™n m√¨nh kh√¥ng khuy·∫øn kh√≠ch ta lu√¥n copy paste m·ªçi th·ª©. Trong t∆∞∆°ng lai, c√≥ th·ªÉ ta nh·∫≠n ra t·∫•t c·∫£ nh·ªØng m·∫£nh gh√©p n√†y ho√†n to√†n v·ª´a kh√≠t cho m·ªôt abstraction, ho·∫∑c ta gh√©p nh·ªØng m·∫£nh kh√°c l·∫°i th√†nh m·ªôt th·ª© m√† ban ƒë·∫ßu ta kh√¥ng nghƒ© ƒë√≥ l√† m·ªôt abstraction t·ªët. C√≥ khi l√† m·ªôt c√°i g√¨ ƒë√≥ ho√†n to√†n kh√°c bi·ªát. V√† t·∫•t c·∫£ nh·ªØng ƒëi·ªÅu n√†y m√¨nh ƒë√£ ch·ªâ c√≥ th·ªÉ nh·∫≠n ra trong qu√° tr√¨nh th·ª±c t·∫ø, c√≤n nh∆∞ khi m√¨nh ƒë∆∞·ª£c h·ªçc, copy pasting l√† m·ªôt ph∆∞∆°ng ph√°p th·ª±c s·ª± ti√™u c·ª±c.

![deconstruct](/assets/posts/deconstruct-best-practices.jpeg "Deconstruct")

L·∫≠p tr√¨nh vi√™n h·ªçc nh·ªØng best practices t·ª´ th·∫ø h·ªá tr∆∞·ªõc v√† c·ªë g·∫Øng l√†m theo ch√∫ng. B·ªüi v√¨ c√≥ nh·ªØng v·∫•n ƒë·ªÅ c·ª• th·ªÉ v√† nh·ªØng gi·∫£i ph√°p c·ª• th·ªÉ ƒë∆∞·ª£c ƒë∆∞a ra b·∫±ng kinh nghi·ªám, n√™n c√°c th·∫ø h·ªá ti·∫øp theo c·ªë g·∫Øng truy·ªÅn ƒë·∫°t l·∫°i. Nh∆∞ng th·∫≠t kh√≥ ƒë·ªÉ c√≥ th·ªÉ gi·∫£i th√≠ch to√†n b·ªô c√¢u chuy·ªán, v·∫≠y l√† ch√∫ng d·∫ßn b·ªã l√†m ph·∫≥ng v√† h·∫ßu nh∆∞ ta ch·ªâ c√≤n t·∫≠p trung v√†o nh·ªØng √Ω t∆∞·ªüng chung chung. Nh·ªØng m·∫∑t h·∫°n ch·∫ø, nh·ªØng l√Ω do ƒë∆∞a ƒë·∫øn gi·∫£i ph√°p ƒë·∫•y, nh·ªØng tr∆∞·ªùng h·ª£p ƒë·ªÉ s·ª≠ d·ª•ng, hay c√≥ th·ªÉ √°p d·ª•ng ƒë·∫øn ƒë√¢u,... T·∫•t c·∫£ d·∫ßn mai m·ªôt theo t·ª´ng th·∫ø h·ªá, v√† ta th√¨ v·∫´n c·ªë g·∫Øng khu√¥n ƒë√∫c v·∫•n ƒë·ªÅ ri√™ng c·ªßa m√¨nh theo nh·ªØng best practices v√† anti-patterns n√†y.

M·ªôt c√°ch ƒë·ªÉ ph√° v·ª° l·ªëi m√≤n n√†y l√† khi ta truy·ªÅn ƒë·∫°t l·∫°i cho th·∫ø h·ªá sau b√†i h·ªçc n√†o ƒë√≥, ta kh√¥ng n√™n phi·∫øn di·ªán kh·∫≥ng ƒë·ªãnh ƒë√¢y l√† best practices hay ƒë√¢y l√† anti-patterns m√† c·∫ßn gi·∫£i th√≠ch nh·ªØng ƒëi·ªÅu g√¨ c·∫ßn ph·∫£i ƒë√°nh ƒë·ªïi, c·∫£ m·∫∑t l·ª£i l·∫´n m·∫∑t h·∫°i.

## II. Benefits of Abstraction
Dƒ© nhi√™n l√† abstraction c√≥ √≠ch. C·ªó m√°y t√≠nh c·ªßa ch√∫ng ta th·ª±c ch·∫•t c·∫•u th√†nh t·ª´ t·∫ßng t·∫ßng l·ªõp l·ªõp c√°c abstraction l·ªìng v√†o nhau. Nh·ªØng kh√°i ni·ªám c∆° b·∫£n nh·∫•t c·ªßa l·∫≠p tr√¨nh, **function**, **procedure**, c≈©ng t·ª´ n√≥ m√† ra.

* Focusing on intent
* Code reuse
* Avoiding some bugs

### Focusing on intent

![deconstruct](/assets/posts/deconstruct-focus-on-intent.gif "Deconstruct")

Abstraction gi√∫p ta t·∫≠p trung v√†o m·ªôt m·ª•c ti√™u c·ª• th·ªÉ. L·∫•y v√≠ d·ª• m·ªôt ·ª©ng d·ª•ng c·∫ßn t√≠nh nƒÉng g·ª≠i email, v√† b·∫°n kh√¥ng mu·ªën ph·∫£i bi·∫øt m·ªôt trƒÉm nƒÉm m∆∞∆°i ba b∆∞·ªõc ƒë·ªÉ g·ª≠i m·ªôt c√°i email, m√¨nh c≈©ng kh√¥ng bi·∫øt m·∫•y email ƒë√≥ ƒë∆∞·ª£c g·ª≠i th·∫ø n√†o. N√≥ v·∫´n c√≤n l√† m·ªôt b√≠ ·∫©n t·∫°i sao ch√∫ng c√≥ th·ªÉ th·∫≠m ch√≠‚Ä¶ t·ªõi ƒë∆∞·ª£c ng∆∞·ªùi nh·∫≠n. Nh∆∞ng m√¨nh c√≥ th·ªÉ d√πng m·ªôt th∆∞ vi·ªán n√†o ƒë√≥ ƒë·ªÉ g·ªçi h√†m sendEmail v√† g·∫ßn nh∆∞ ch·∫≥ng c·∫ßn ph·∫£i quan t√¢m g√¨ th√™m.

### Code reuse

![deconstruct](/assets/posts/deconstruct-code-reuse.gif "Deconstruct")

V√† m·ªôt l·ª£i √≠ch ph·ªï bi·∫øn n·ªØa c·ªßa abstraction, t√°i s·ª≠ d·ª•ng nh·ªØng ƒëo·∫°n code c·ªßa b·∫°n hay ng∆∞·ªùi kh√°c m√† kh√¥ng c·∫ßn ph·∫£i nh·ªõ c√°ch m√† ch√∫ng ho·∫°t ƒë·ªông.

### Avoiding some bugs

![deconstruct](/assets/posts/deconstruct-avoid-bugs.gif "Deconstruct")

Nh·ªØng l·ªõp abstraction n√†y c√≤n gi√∫p ta tr√°nh ƒë∆∞·ª£c m·ªôt s·ªë bug. V√≠ d·ª• ta copy paste m·ªôt ƒëo·∫°n code, sau ƒë√≥ ph√°t hi·ªán bug trong m·ªôt phi√™n b·∫£n v√† fix n√≥, nh∆∞ng phi√™n b·∫£n c√≤n l·∫°i v·∫´n b·ªã l·ªói v√† nhi·ªÅu khi kh√¥ng ƒë∆∞·ª£c ch√∫ √Ω. ƒê√¢y c≈©ng l√† m·ªôt lu·∫≠n ƒëi·ªÉm t·∫°i sao n√™n h·∫°n ch·∫ø ƒë·ªÉ l·∫∑p code.

## III. Costs of Abstraction
Nh∆∞ng khi n√≥i ƒë·∫øn l·ª£i √≠ch ta c≈©ng n√™n n√≥i v·ªÅ nh·ªØng h·∫°n ch·∫ø c·ªßa abstraction:

* Accidental coupling
* Extra indirection
* Inertia

### Accidental coupling

![deconstruct](/assets/posts/deconstruct-accidential-coupling.gif "Deconstruct")

Khi ta c√≥ hai module s·ª≠ d·ª•ng chung abstraction, r·ªìi sau ƒë√≥ ph√°t hi·ªán m·ªôt module x·∫£y ra l·ªói, ta s·∫Ω ph·∫£i s·ª≠a l·ªõp abstraction b·ªüi ƒë√¢y m·ªõi l√† n∆°i c·ªßa ƒëo·∫°n code. Nh∆∞ng b√¢y gi·ªù ta s·∫Ω ph·∫£i ch·ªãu tr√°ch nhi·ªám c√¢n nh·∫Øc t·∫•t c·∫£ c√°c module kh√°c ph·ª• thu·ªôc v√†o l·ªõp abstraction ƒë·∫•y ƒë·ªÉ kh√¥ng l√†m xu·∫•t hi·ªán nh·ªØng l·ªói kh√°c. ƒê√¢y l√† m·ªôt b·∫•t l·ª£i th∆∞·ªùng th·∫•y khi d√πng abstraction, v√† ch√∫ng ta th∆∞·ªùng ch·ªãu s·ªëng chung v·ªõi ƒëi·ªÅu n√†y, nh∆∞ng n√≥ v·∫´n l√† m·ªôt ƒëi·ªÉm b·∫•t l·ª£i th·ª±c s·ª±.

### Extra indirection

![deconstruct](/assets/posts/deconstruct-extra-indirection.gif "Deconstruct")

M·ªôt h·∫°n ch·∫ø kh√°c th·∫≠m ch√≠ c√≤n tai h·∫°i h∆°n: nh·ªØng th·ª© d∆∞ th·ª´a ta ph·∫£i b·∫≠n t√¢m m√† abstraction c√≥ th·ªÉ g√¢y ra. Nghe c√≥ v·∫ª ngh·ªãch l√Ω v·ªõi m·ªôt l·ª£i √≠ch v·ª´a n√£y, nh∆∞ng l·ªùi h·ª©a h·∫πn ‚Äúfocusing on intent‚Äù ƒë·ªÉ gi√∫p ta kh√¥ng ph·∫£i quan t√¢m ƒë·∫øn nh·ªØng th·ª© kh√¥ng c·∫ßn thi·∫øt li·ªáu c√≥ ho√†n to√†n ƒë√∫ng? M√¨nh ch·∫Øc r·∫±ng h·∫ßu h·∫øt m·ªçi ng∆∞·ªùi ƒë·ªÅu t·ª´ng c√≥ m·ªôt l·ªói xu·∫•t hi·ªán trong m·ªôt feature, sau ƒë√≥ t√¨m ra n√≥ n·∫±m ·ªü function kh√°c, m√† th·ª±c ra kh√¥ng ph·∫£i, n√≥ xu·∫•t hi·ªán t·ª´ m·ªôt module kh√°c, nh∆∞ng r·ªìi nh·∫≠n ra n√≥ ph·ª• thu·ªôc v√†o m·ªôt l·ªõp kh√°c n·ªØa.

B·ªô n√£o con ng∆∞·ªùi c√≥ nh·ªØng ngƒÉn x·∫øp (Stack) ƒë·ªÉ x·ª≠ l√Ω m·ªôt s·ªë l∆∞·ª£ng c·ª±c k·ª≥ h·∫°n ch·∫ø c√°c c√¥ng vi·ªác, v√† n√≥ s·∫Ω tr√†n (StackOverflow) n·∫øu kh√¥ng c√≥ ƒë∆∞·ª£c s·ª± qu·∫£n l√Ω t·ªët. Ch·∫Øc ƒë√≥ c≈©ng l√† l√Ω do cho c√°i t√™n c·ªßa trang web m√† c√°c l·∫≠p tr√¨nh vi√™n ƒë·ªÅu bi·∫øt l√† trang n√†o ƒë√≥.

Ta c·ªë g·∫Øng ƒë·ªÉ h·∫°n ch·∫ø nh·ªØng ƒëo·∫°n m√£ l·∫∑p m√† ta nghƒ© r·∫±ng x·∫•u x√≠ b·∫±ng c∆° s·ªë t·∫ßng t·∫ßng l·ªõp l·ªõp cho ƒë·∫øn khi ta kh√¥ng c√≤n hi·ªÉu ƒë∆∞·ª£c chuy·ªán g√¨ ƒëang x·∫£y ra n·ªØa.

### Inertia
Ngo√†i v·∫•n ƒë·ªÅ k·ªπ thu·∫≠t, √°p d·ª•ng sai abstraction c√≤n g√¢y ra ·∫£nh h∆∞·ªüng x·∫•u t·ªõi vƒÉn ho√° l√†m vi·ªác c·ªßa nh√≥m, s·ª± ch·∫≠m ch·∫°p v√† l∆∞·ªùi bi·∫øng.

![deconstruct](/assets/posts/deconstruct.042.jpeg "Deconstruct")

Ta b·∫Øt ƒë·∫ßu m·ªôt abstraction c√≥ v·∫ª ƒë·∫ßy h·ª©a h·∫πn, r·ªìi theo th·ªùi gian n√≥ c√†ng tr·ªü n√™n ph·ª©c t·∫°p, nh∆∞ng kh√¥ng m·ªôt ai c√≥ th·ªùi gian ƒë·ªÉ g·ª° r·ªëi hay vi·∫øt l·∫°i n√≥, ƒë·∫∑c bi·ªát n·∫øu nh∆∞ b·∫°n m·ªõi tham gia v√†o d·ª± √°n. Vi·ªác copy-paste c√≥ th·ªÉ ƒë∆°n gi·∫£n, nh∆∞ng n·∫øu b·∫°n kh√¥ng quen thu·ªôc v·ªõi project t·ª´ ƒë·∫ßu n√≥ c√≥ th·ªÉ tr·ªü n√™n c·ª±c k·ª≥ kh√≥ khƒÉn.

![deconstruct](/assets/posts/deconstruct.043.jpeg "Deconstruct")

M·ªôt ƒëi·ªÅu n·ªØa l√† ch·∫≥ng ai trong ch√∫ng ta mu·ªën tr·ªü th√†nh ng∆∞·ªùi ch·ªâ ƒë∆∞a ra nh·ªØng ‚Äúworse practices‚Äù. Ai l·∫°i mu·ªën n√≥i, ‚Äúh√£y copy paste c√°i n√†y?‚Äù, nh·∫Øm xem b·∫°n c√≥ pass ƒë∆∞·ª£c probation ko? V·∫≠y n√™n b·∫°n h·ªçc c√°ch ch·∫•p nh·∫≠n hi·ªán t·∫°i r·ªìi c·ª© ti·∫øp t·ª•c v√† hy v·ªçng ƒë·∫øn m·ªôt ng√†y kh√¥ng ph·∫£i ch·ªãu tr√°ch nhi·ªám t·ªõi ƒë·ªëng code ·∫•y n·ªØa.

![deconstruct](/assets/posts/deconstruct.044.jpeg "Deconstruct")

V√† v·∫•n ƒë·ªÅ l√† th·∫≠m ch√≠ c·∫£ nh√≥m ƒë√£ ƒë·ªìng √Ω inline abstraction ·∫•y, c√≥ khi ƒë√£ qu√° mu·ªôn. C√≥ th·ªÉ b·∫°n bi·∫øt ƒë∆∞·ª£c m·ª•c ƒë√≠ch v√† c√°ch d√πng c·ªßa abstraction, v√† l√†m sao ƒë·ªÉ test n√≥. ƒê·ªÉ khi t√°i c·∫•u tr√∫c hay ph√¢n t√°ch ch√∫ng, b·∫°n hi·ªÉu ƒë∆∞·ª£c c√°ch x√°c th·ª±c nh·ªØng thay ƒë·ªïi m√† kh√¥ng l√†m h∆∞ h·ªèng c√°c ph·∫ßn kh√°c. Nh∆∞ng c√≥ khi abstraction l√∫c n√†y ƒë√£ ƒë∆∞·ª£c ph·ª• tr√°ch b·ªüi c√°c team kh√°c, hay tr·∫£i qua m·ªôt th·ªùi gian kh√¥ng ai maintain, ƒë·∫øn khi kh√¥ng c√≤n ai bi·∫øt c√°ch test ch·ªó code n√†y n·ªØa.

![deconstruct](/assets/posts/deconstruct-multiple-team.gif "Deconstruct")

## IV. Abstract Responsibly
T·∫•t nhi√™n, s·∫Ω th·∫≠t phi·∫øn di·ªán n·∫øu n√≥i r·∫±ng ta kh√¥ng n√™n t·∫°o abstraction. V·∫•n ƒë·ªÅ ·ªü ƒë√¢y l√† ta s·∫Ω m·∫Øc nh·ªØng sai l·∫ßm, nh∆∞ng l√†m sao ta c√≥ th·ªÉ gi·∫£m thi·ªÉu nh·ªØng h·∫≠u qu·∫£ m√† ch√∫ng g√¢y ra:

* Test concrete code
* Delay adding layers
* Be ready to inline it

### Test concrete code
M·ªôt b√†i h·ªçc m√¨nh h·ªçc ƒë∆∞·ª£c t·ª´ c√°c d·ª± √°n m√£ ngu·ªìn m·ªü l√† h√£y test nh·ªØng ƒëo·∫°n code c√≥ gi√° tr·ªã c·ª• th·ªÉ. V√≠ nh∆∞ ta c√≥ m·ªôt abstraction, v√† ta l∆∞·ª£m ƒë∆∞·ª£c ch√∫t th·ªùi gian ƒë·ªÉ vi·∫øt m·ªôt s·ªë ƒëo·∫°n test. V·∫≠y l√† ta h√¨ h·ª•c vi·∫øt test cho abstraction n∆°i ch·ª©a nh·ªØng ƒëo·∫°n code ph·ª©c t·∫°p.

V√† theo m√¨nh th·ª±c ra ƒë√¢y l√† m·ªôt √Ω t∆∞·ªüng t·ªìi, b·ªüi sau ƒë√≥ n·∫øu b·∫°n nh·∫≠n ra ƒë√≥ l√† abstraction x·∫•u v√† mu·ªën inline ch√∫ng, th·ª≠ nghƒ© ƒëi·ªÅu g√¨ s·∫Ω x·∫£y ƒë·∫øn v·ªõi nh·ªØng test case n√†y? T·∫•t c·∫£ ch√∫ng ƒë·ªÅu fail. V√† b·∫°n s·∫Ω ph·∫£i: 1. revert l·∫°i v√¨ b·∫°n kh√¥ng mu·ªën ph·∫£i vi·∫øt l·∫°i t·∫•t c·∫£ ƒëo·∫°n test; 2. ch·ªãu gi·∫£m code coverage, vi·ªác m√† ch·∫Øc ch·∫≥ng ai mu·ªën c·∫£.

![deconstruct](/assets/posts/deconstruct-wrong-test.gif "Deconstruct")

Nh∆∞ng n·∫øu ta l·∫°i c√≥ ƒë∆∞·ª£c c·ªó m√°y th·ªùi gian ƒë·ªÉ quay l·∫°i v√† vi·∫øt test cho nh·ªØng ch·ªó th·ª±c s·ª± c·∫ßn quan t√¢m ƒë·∫øn: Nh·ªØng test case cho ch√≠nh feature ph·∫£i ho√†n th√†nh v√† kh√¥ng li√™n quan ƒë·∫øn abstraction. Vi·ªác n√†y s·∫Ω gi√∫p ta t√°i c·∫•u tr√∫c abstraction d·ªÖ d√†ng, nh·ªØng test case n√†y s·∫Ω ch·ªâ ra n·∫øu ƒëo·∫°n code ƒë∆∞·ª£c refactor c√≥ ho·∫°t ƒë·ªông ƒë√∫ng.

![deconstruct](/assets/posts/deconstruct-correct-test.gif "Deconstruct")

### Delay adding layers
M·ªôt y·∫øu t·ªë n·ªØa, c√≥ th·ªÉ b·∫°n nh·∫≠n ƒë∆∞·ª£c m·ªôt pull request v·ªõi v√†i ƒëo·∫°n code b·ªã l·∫∑p v√† ch·ªâ mu·ªën bay v√¥ x·ª≠ ƒë·∫πp h·∫øt? H√£y b√¨nh tƒ©nh!

Nghƒ© nh∆∞ th·∫ø n√†y, b·∫°n b∆∞·ªõc v√†o th∆∞ vi·ªán v√† nh√¨n th·∫•y c√¥ g√°i b·∫°n crush ƒë·ªçc quy·ªÉn s√°ch b·∫°n y√™u th√≠ch, c≈©ng kh√¥ng ƒë·ªìng nghƒ©a v·ªõi vi·ªác b·∫°n v√† c√¥ ·∫•y c√≥ th·ªÉ c√≥ nhi·ªÅu ƒëi·ªÉm chung, v√† b·∫°n google t√¨m m·ªôt tr∆∞·ªùng m·∫´u gi√°o cho t∆∞∆°ng lai‚Ä¶ Ch·ªâ v√¨ c·∫•u tr√∫c c·ªßa hai ƒëo·∫°n m√£ tr√¥ng gi·ªëng nhau, nhi·ªÅu khi do b·∫°n ch∆∞a th·ª±c s·ª± hi·ªÉu h·∫øt v·∫•n ƒë·ªÅ ·∫•y. H√£y d√†nh th√™m th·ªùi gian ƒë·ªÉ ch·ª©ng minh ƒë∆∞·ª£c r·∫±ng ch√∫ng l√† c√πng m·ªôt v·∫•n ƒë·ªÅ ch·ª© kh√¥ng ch·ªâ v√¥ t√¨nh gi·ªëng nhau.

### Be ready to inline it
V√† cu·ªëi c√πng, c≈©ng r·∫•t quan tr·ªçng, r·∫±ng n·∫øu b·∫°n m·∫Øc sai l·∫ßm, c√°i m√† team c·∫ßn h·ªçc ƒë∆∞·ª£c l√† s·ª± ch·∫•p nh·∫≠n, r·∫±ng abstraction n√†y ƒëang g√¢y ra t√°c ƒë·ªông x·∫•u v√† ph·∫£i b·ªã lo·∫°i b·ªè. Ch√∫ng ta kh√¥ng n√™n ch·ªâ th√™m abstraction, m√† c≈©ng ph·∫£i xo√° ch√∫ng khi c·∫ßn thi·∫øt, n·∫øu mu·ªën x√¢y d·ª±ng m·ªôt quy tr√¨nh ph√°t tri·ªÉn l√†nh m·∫°nh. ƒêi·ªÅu ƒë√≥ c√≥ nghƒ©a l√† b·∫°n ho√†n to√†n c√≥ th·ªÉ ƒë·ªÉ l·∫°i m·ªôt b√¨nh lu·∫≠n nh∆∞ th·∫ø n√†y v√† n√≥i, √¢y, c√°i n√†y ƒëang v∆∞·ª£t qu√° t·∫ßm ki·ªÉm so√°t:

![deconstruct](/assets/posts/deconstruct-inline.jpeg "Deconstruct")

H√£y d√†nh m·ªôt ch√∫t th·ªùi gian ƒë·ªÉ copy-paste v√† sau ƒë√≥ ta s·∫Ω t√¨m ra nh·ªØng g√¨ c·∫ßn l√†m ti·∫øp theo.

### Plus
Ngo√†i ra ta c√≤n c√≥ m·ªôt gi·∫£i ph√°p v·ªÅ k·ªπ thu·∫≠t cho v·∫•n ƒë·ªÅ n√†y. N·∫øu c·∫•u tr√∫c ·ª©ng d·ª•ng c·ªßa b·∫°n nh∆∞ th·∫ø n√†y, c≈©ng s·∫Ω r·∫•t kh√≥ khƒÉn ƒë·ªÉ inline d√π ta c√≥ mu·ªën l√†m. V√≠ d·ª• nh∆∞ b·∫°n copy v√† paste ch·ªó n√†y, d·∫´n ƒë·∫øn m·ªôt s·ªë d·ªØ li·ªáu hay state d√πng chung c≈©ng b·ªã duplicate, ho·∫∑c ta ph·∫£i g·ª° r·ªëi cho h·∫øt ƒë·ªëng dependency r·ªìi n·ªëi ch√∫ng l·∫°i v·ªõi nhau. V√† ƒë√¢y l√† m·ªôt nhi·ªám v·ª• b·∫•t kh·∫£ thi trong nhi·ªÅu tr∆∞·ªùng h·ª£p.

![deconstruct](/assets/posts/deconstruct-mess.gif "Deconstruct")

C≈©ng t·ª´ ƒë·∫•y theo m√¨nh, m·ªôt ƒëi·ªÉm r·∫•t th√¥ng minh c·ªßa React l√† gi√∫p ta vi·∫øt theo c·∫•u tr√∫c h√¨nh c√¢y. Ta c√≥ m·ªôt input component n·∫±m trong m·ªôt form component, ƒë∆∞·ª£c bao trong m·ªôt screen component v√† t·∫•t c·∫£ ƒë∆∞·ª£c g·ªôp l·∫°i trong app. T·∫•t c·∫£ nh·ªØng lu·ªìng d·ªØ li·ªáu ch·ªâ theo m·ªôt h∆∞·ªõng ƒëi duy nh·∫•t, ta kh√¥ng ph·∫£i lo l·∫Øng n·∫øu m·ªçi th·ª© ph·ª• thu·ªôc ch√©o l·∫´n nhau trong m·ªôt v√≤ng l·∫∑p v√¥ t·∫≠n‚Ä¶

![deconstruct](/assets/posts/deconstruct-react.gif "Deconstruct")

C√≤n b·ªüi v√¨ nh·ªù c√°c components v√† m·ªôt s·ªë gi·∫£i ph√°p nh∆∞ state management, ta c√≥ th·ªÉ d·ªÖ d√†ng refactor c√°c abstraction n·∫øu mu·ªën tr∆∞·ªõc khi qu√° tr·ªÖ. ƒê√¢y l√† th·ª© ta c√≥ th·ªÉ c√¢n nh·∫Øc v·ªÅ c·∫£ hai m·∫∑t x√£ h·ªôi v√† c√¥ng ngh·ªá.
## V. Deconstruct
verb
*ÀådiÀê.k…ônÀàstr åkt*

**to break something down into its separate parts in order to understand its meaning, especially when this is different from how it was previously understood:**

*We should deconstruct the Western myth of human rights.*

(theo [Cambridge Dictionary](https://dictionary.cambridge.org/vi/dictionary/english/deconstruct))

---

![dry and all the things](/assets/posts/deconstruct-lost-in-tech.png "dry and all the things")

‚ÄúDon‚Äôt Repeat Yourself‚Äù, c≈©ng nh∆∞ l√† m·ªôt trong s·ªë nh·ªØng nguy√™n t·∫Øc m√† c√≥ l·∫Ω c≈©ng l√† nh·ªØng √Ω t∆∞·ªüng hay m√† ta lu√¥n ch·ªãu ·∫£nh h∆∞·ªüng h·∫±ng ng√†y. Chuy·ªán n√†y c≈©ng ho√†n to√†n b√¨nh th∆∞·ªùng, c√°i quan tr·ªçng l√† khi ta mu·ªën gi·∫£i th√≠ch t·∫°i sao ch√∫ng l√† √Ω t∆∞·ªüng t·ªët, ta c≈©ng n√™n quan t√¢m ƒë·∫øn m·∫∑t h·∫°n ch·∫ø v√† ƒëi·ªÅu g√¨ d·∫´n ta ƒë·∫øn gi·∫£i ph√°p ·∫•y. V√† c√≥ th·ªÉ s·∫Ω r·∫•t kh√≥ ƒë·ªÉ n·∫Øm b·∫Øt ƒë∆∞·ª£c t·∫•t c·∫£ ch√∫ng. Nh∆∞ng ta c√≥ th·ªÉ b·∫Øt ƒë·∫ßu t·ª´ nh·ªØng th·ª© nh·ªè h∆°n, quen thu·ªôc h∆°n.

H√£y ch·ªçn m·ªôt v√†i **best practices** v√† **anti-patterns** m√† b·∫°n ƒë√£ lu√¥n tin t∆∞·ªüng l√† ƒë√∫ng, ch√∫ng c√≥ th·ªÉ ƒë·∫øn t·ª´ tr·∫£i nghi·ªám c·ªßa b·∫°n ho·∫∑c t·ª´ b·∫•t k·ª≥ ƒë√¢u, v√† th·ª±c s·ª± c·ªë g·∫Øng ph√¢n t√≠ch, gi·∫£i m√£ ƒë·ªÉ t√¨m ra l√Ω do ƒë√£ khi·∫øn b·∫°n tin, nh·ªØng ƒëi·ªÅu ƒë√£ b·ªã che l·∫•p m·∫•t, v√† nh·ªØng th·ª© ta ƒë√£ ph·∫£i ƒë√°nh ƒë·ªïi.

ƒê√≥ c≈©ng l√† t·∫•t c·∫£ n·ªôi dung m√† m√¨nh ƒë√£ chu·∫©n b·ªã. B·∫°n c≈©ng c√≥ th·ªÉ t√¨m hi·ªÉu th√™m m·ªôt s·ªë b√†i talks m√† m√¨nh ƒë√£ h·ªçc v√† l·∫•y √Ω t∆∞·ªüng:

- **So All the Little Things** b·ªüi *Sandi Metz*, m·ªôt b√†i talk r·∫•t hay, ƒëi s√¢u v√†o chi ti·∫øt v√† hi·ªán th·ª±c c√°c quan ƒëi·ªÉm tr√™n.

- **Minimal API Surface Area** b·ªüi *Sebastian Markbage*. M√¨nh h·ªçc ƒë∆∞·ª£c r·∫•t nhi·ªÅu t·ª´ anh n√†y, m·ªôt th√†nh vi√™n c·ªßa React Core Team. **‚ÄúNo Abstraction‚Äù > ‚ÄúWrong Abstraction‚Äù**.

- **On the Spectrum of Abstractions** b·ªüi *Cheng Lou*, t√¨m hi·ªÉu nhi·ªÅu kh√≠a c·∫°nh h∆°n c·ªßa Abstraction, v√† d√πng Abstract level ƒë·ªÉ gi·∫£i th√≠ch nhi·ªÅu v·∫•n ƒë·ªÅ nh·∫°y c·∫£m: React vs Template, CSS-in-JS vs Plain CSS, mutable vs immutable‚Ä¶

![m·ªôt chi·∫øc ·∫£nh k·ª∑ ni·ªám, InApps, 21/8/2020](/assets/posts/deconstruct-me.jpg "m·ªôt chi·∫øc ·∫£nh k·ª∑ ni·ªám, InApps, 21/8/2020")
